<h3 *ngIf="isOwner$ | ngrxPush" i18n="@@uploadAdditionalMediaTitle">
  Upload additional media files
</h3>

<form
  class="upload-form"
  [formGroup]="formGroup"
  (ngSubmit)="onClickSubmit()"
  *ngIf="isOwner$ | ngrxPush"
>
  <div class="first-row">
    <mat-form-field appearance="fill" class="title">
      <mat-label i18n="@@uploadAdditionalMediaVideoTitleLabel"
        >Video title</mat-label
      >
      <input
        matInput
        formControlName="title"
        placeholder="Video title"
        i18n-placeholder="@@uploadAdditionalMediaVideoTitlePlaceholder"
      />
    </mat-form-field>

    <mat-form-field class="category">
      <mat-label i18n="@@uploadAdditionalMediaVideoCategoryLabel"
        >Choose a category</mat-label
      >
      <mat-select formControlName="category">
        <!-- TODO media category i18n -->
        @for (category of selectableMediaCategories; track $index) {
        <mat-option value="category">{{ category | mediaCategory }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
  </div>
  <div class="second-row">
    <div class="upload-wrapper">
      <input
        #fileUpload
        formControlName="file"
        type="file"
        name="file"
        single
        accept="video/*"
        (change)="onFileChange($event)"
      />
    </div>

    <button
      (click)="onClickSubmit()"
      mat-flat-button
      color="primary"
      [disabled]="formGroup.status === 'INVALID'"
      i18n="@@uploadAdditionalMediaUploadButton"
    >
      <mat-icon svgIcon="upload"></mat-icon>
      Upload
    </button>
  </div>
</form>
<div *ngIf="fileUploads.length > 0">
  <h3 i18n="@@uploadAdditionalMediaUploadingHeader">Uploading</h3>
  <ul class="upload-list">
    <li *ngFor="let fileUpload of fileUploads">
      {{ fileUpload.name }}
      <mat-progress-bar
        *ngIf="fileUpload.loaded && fileUpload.totalSize"
        mode="determinate"
        [value]="(fileUpload.loaded / fileUpload.totalSize) * 100"
      ></mat-progress-bar>

      <!-- {{ (fileUpload.loaded / fileUpload.totalSize) * 100 }}% -->
      <button mat-icon-button (click)="onCancelUpload(fileUpload)">
        <mat-icon svgIcon="close"></mat-icon>
      </button>
    </li>
  </ul>
</div>

<ng-container *ngrxLet="project$ as project">
  <hr />

  <div *ngIf="project">
    <h3 i18n="@@uploadAdditionalMediaListHeader">Videos</h3>
    <ul>
      <li *ngFor="let video of project.videos">
        {{ video.title }} -- {{ video.category }}
        <button
          mat-icon-button
          (click)="onDeleteAdditionalMedia(project, video)"
        >
          <mat-icon svgIcon="delete"></mat-icon>
        </button>
      </li>
    </ul>
  </div>
</ng-container>
