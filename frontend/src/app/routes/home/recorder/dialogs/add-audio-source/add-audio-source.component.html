<h2 mat-dialog-title>Add Audiosource</h2>
<mat-dialog-content class="mat-dialog-content">
  @if (loading) {
    <div class="flex justify-center" style="margin-top: 20px">
      <mat-spinner></mat-spinner>
    </div>
  }
  @if (loadingError) {
    {{ loadingError }}
  }
  @if (!loading && !loadingError) {
    <mat-form-field style="width: 100%">
      <mat-label>sources</mat-label>
      <mat-select
        [(ngModel)]="currentInput"
        (selectionChange)="onSelectionChange()"
        >
        @for (audioInput of audioinputs; track audioInput) {
          <mat-option [value]="audioInput">
            {{ audioInput.label }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>
    <mat-form-field style="width: 100%">
      <mat-label>Title</mat-label>
      <input matInput type="text" [(ngModel)]="audioSource.title" />
    </mat-form-field>
    <br />
    @if (audioSource.mediaStream) {
      <div class="audio-wrapper">
        <audio [srcObject]="audioSource.mediaStream" autoplay></audio>
        <div class="meter-wrapper">
          <span> Audio level </span>
          <div class="meter">
            <app-audio-meter
              [mediaStream]="audioSource.mediaStream"
            ></app-audio-meter>
          </div>
        </div>
      </div>
    }
    @if (!audioSource.mediaStream) {
      <div
        class="flex justify-center"
        style="margin-top: 20px; width: 100%; height: 80px"
        >
        <mat-spinner></mat-spinner>
      </div>
    }
  }
</mat-dialog-content>
<mat-dialog-actions>
  <button color="primary" mat-flat-button (click)="onCloseDialog()">
    Cancel
  </button>
  @if (!loadingError && !loading && !loadingError) {
    <button
      color="primary"
      mat-flat-button
      (click)="onSubmitDialog()"
      >
      Add
    </button>
  }
  @if (loadingError) {
    <button
      color="primary"
      mat-flat-button
      (click)="onClickTryAgain()"
      >
      Erneut versuchen
      <mat-icon svgIcon="repeat" class="svg-black"></mat-icon>
    </button>
  }
</mat-dialog-actions>
