<div mat-dialog-title>
  <div class="dialog-header">
    <div>
      <h1 i18n="@@dialogChangePasswordHeader">Change Password</h1>
    </div>

    <button
      mat-icon-button
      [mat-dialog-close]="true"
      aria-label="Close"
      i18n-aria-label="@@dialogChangePasswordCloseButton"
    >
      <mat-icon svgIcon="close" />
    </button>
  </div>
</div>

<mat-dialog-content>
  <form [formGroup]="changePasswordForm">
    <mat-form-field>
      <mat-label>Current Password</mat-label>
      <input matInput type="password" formControlName="currentPassword" />
      @if (changePasswordForm.controls.currentPassword.hasError('required')) {
      <mat-error> Current password required </mat-error>
      }
    </mat-form-field>

    <mat-form-field>
      <mat-label>New Password</mat-label>
      <input matInput type="password" formControlName="newPassword" />
      @if (changePasswordForm.controls.newPassword.hasError('required')) {
      <mat-error> New password required </mat-error>
      }
    </mat-form-field>
    <mat-form-field>
      <mat-label>Confirm New Password</mat-label>
      <input matInput type="password" formControlName="confirmPassword" />
      @if (changePasswordForm.controls.confirmPassword.hasError('required')) {
      <mat-error>Confirm new password required</mat-error>
      }
    </mat-form-field>

    <!-- <ng-container *ngrxLet="changePasswordError$ as changePasswordError">
      @if (changePasswordError) {
      <div class="error-message" aria-live="polite">
        <mat-icon svgIcon="warning"></mat-icon>
        <p>Error: {{ changePasswordError }}</p>
      </div>
      } @else if (changePasswordSubmitted) {
      <div class="success-message" aria-live="polite">
        <mat-icon svgIcon="check"></mat-icon>
        <p>Password changed!</p>
      </div>
      }
    </ng-container> -->
  </form>

  <div class="error-wrapper" aria-live="polite">
    @if (changePasswordForm.hasError('notSame')){
    <div class="error">
      <mat-icon svgIcon="warning" />
      <p>Passwords do not match</p>
    </div>
    } @if (changePasswordError) {
    <div class="error">
      <mat-icon svgIcon="warning" />
      <p>{{ changePasswordError }}</p>
    </div>
    }
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button
    (click)="onSubmitChangePassword()"
    mat-raised-button
    color="primary"
    type="submit"
  >
    Change Password
  </button>
</mat-dialog-actions>
