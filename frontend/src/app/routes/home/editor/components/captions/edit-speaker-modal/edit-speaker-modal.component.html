<div>
  <button
    mat-menu-item
    *ngFor="let speaker of availableSpeaker$ | ngrxPush"
    (click)="changeSpeaker(caption, speaker)"
    class="stayfocused-{{ caption.id }}"
  >
    <mat-icon svgIcon="speaker1"></mat-icon>
    <span>{{ speaker.name }}</span>
  </button>
  <mat-divider class="speaker-mat-divider"></mat-divider>
  <div (click)="$event.stopPropagation()" class="add-speaker-wrapper">
    <button
      mat-stroked-button
      class="speaker-mode-button stayfocused-{{ caption.id }}"
      *ngIf="!addSpeakerMode"
      (click)="onAddSpeakerMode()"
      i18n="@@captionsAddNewSpeakerButtonLabel"
    >
      <mat-icon svgIcon="add"></mat-icon>
      Add speaker
    </button>
    <div *ngIf="addSpeakerMode" class="add-speaker-mode-wrapper">
      <mat-form-field class="speaker-form-field">
        <mat-label i18n="@@captionsNewSpeakerNameLabel"
          >New speaker name</mat-label
        >
        <input
          #newSpeaker
          [errorStateMatcher]="errorStateMatcher"
          matInput="text"
          [formControl]="newSpeakerForm"
          class="stayfocused-{{ caption.id }}"
        />
        <mat-error *ngIf="!newSpeakerForm.valid">{{
          onNewSpeakerInvalid()
        }}</mat-error>
      </mat-form-field>
      <button
        [disabled]="!newSpeakerForm.valid"
        mat-flat-button
        color="primary"
        (click)="onAddSpeaker(caption, newSpeaker.value)"
        i18n="@@captionsAddSpeakerButtonLabel"
        class="stayfocused-{{ caption.id }}"
      >
        Add
      </button>
    </div>
  </div>
</div>
